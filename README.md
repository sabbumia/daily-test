# English Learning Platform

A modern web application for daily English vocabulary tests powered by Google Gemini AI.

## Features

- ðŸ¤– **AI-Powered Tests**: Daily vocabulary tests generated by Google Gemini
- ðŸ“Š **Progress Tracking**: Monitor your scores and improvement over time
- ðŸ”’ **Secure Authentication**: JWT-based user authentication
- ðŸ“… **Sequential Learning**: Must complete previous tests to access new ones
- ðŸ’¾ **Persistent Data**: All progress saved in Neon PostgreSQL database

## Tech Stack

- **Frontend**: Next.js 14, TypeScript, Tailwind CSS
- **Backend**: Next.js API Routes
- **Database**: Neon PostgreSQL with Drizzle ORM
- **AI**: Google Gemini 2.0 Flash
- **Authentication**: JWT with bcrypt

## Prerequisites

- Node.js 18+ 
- Neon Database account
- Google Gemini API key

## Installation

1. **Clone the repository**
```bash
git clone <your-repo-url>
cd english-learning-platform
```

2. **Install dependencies**
```bash
npm install
```

3. **Set up environment variables**

Create a `.env` file in the root directory:

```env
DATABASE_URL="postgresql://user:password@host/database?sslmode=require"
JWT_SECRET="your-super-secret-jwt-key"
GEMINI_API_KEY="your-gemini-api-key"
CRON_SECRET="your-cron-secret-key"
```

**Getting your keys:**

- **Neon Database**: Sign up at [neon.tech](https://neon.tech) and create a project
- **Gemini API Key**: Get it from [Google AI Studio](https://makersuite.google.com/app/apikey)
- **JWT_SECRET**: Generate a random string (use `openssl rand -base64 32`)
- **CRON_SECRET**: Generate another random string for securing cron endpoints

4. **Set up the database**

```bash
npm run db:push
```

This will create all necessary tables in your Neon database.

5. **Run the development server**

```bash
npm run dev
```

Open [http://localhost:3000](http://localhost:3000) in your browser.

## Project Structure

```
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”œâ”€â”€ auth/
â”‚   â”‚   â”‚   â”œâ”€â”€ signin/route.ts
â”‚   â”‚   â”‚   â””â”€â”€ signup/route.ts
â”‚   â”‚   â”œâ”€â”€ tests/
â”‚   â”‚   â”‚   â”œâ”€â”€ available/route.ts
â”‚   â”‚   â”‚   â””â”€â”€ [id]/
â”‚   â”‚   â”‚       â”œâ”€â”€ route.ts
â”‚   â”‚   â”‚       â””â”€â”€ submit/route.ts
â”‚   â”‚   â””â”€â”€ cron/
â”‚   â”‚       â””â”€â”€ generate-test/route.ts
â”‚   â”œâ”€â”€ dashboard/page.tsx
â”‚   â”œâ”€â”€ signin/page.tsx
â”‚   â”œâ”€â”€ signup/page.tsx
â”‚   â”œâ”€â”€ test/[id]/page.tsx
â”‚   â”œâ”€â”€ layout.tsx
â”‚   â”œâ”€â”€ page.tsx
â”‚   â””â”€â”€ globals.css
â”œâ”€â”€ db/
â”‚   â”œâ”€â”€ index.ts
â”‚   â””â”€â”€ schema.ts
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ auth.ts
â”‚   â”œâ”€â”€ authMiddleware.ts
â”‚   â””â”€â”€ gemini.ts
â””â”€â”€ ...config files
```

## Database Schema

### Users Table
- `id`: Primary key
- `email`: Unique email address
- `password`: Hashed password
- `name`: User's full name
- `createdAt`: Timestamp

### Daily Tests Table
- `id`: Primary key
- `testDate`: Unique date for the test
- `words`: JSON array of word objects
- `createdAt`: Timestamp

### User Test Attempts Table
- `id`: Primary key
- `userId`: Foreign key to users
- `testId`: Foreign key to daily_tests
- `score`: Test score out of 10
- `answers`: JSON array of user answers
- `completed`: Boolean flag
- `attemptedAt`: Timestamp

## Deployment

### Deploy to Vercel

1. Push your code to GitHub

2. Import your project to Vercel

3. Add environment variables in Vercel dashboard

4. Create `vercel.json` in root directory:

```json
{
  "crons": [
    {
      "path": "/api/cron/generate-test",
      "schedule": "0 0 * * *"
    }
  ]
}
```

5. Deploy!

### Cron Job Setup

The application uses Vercel Cron Jobs to generate daily tests at midnight UTC.

- **Path**: `/api/cron/generate-test`
- **Schedule**: `0 0 * * *` (daily at midnight)
- **Authentication**: Uses `CRON_SECRET` header

To manually trigger test generation:
```bash
curl -X POST http://localhost:3000/api/cron/generate-test
```

## Usage

1. **Sign Up**: Create a new account
2. **Dashboard**: View your progress and available tests
3. **Take Tests**: Complete tests sequentially (previous tests must be completed first)
4. **Review Results**: See your score and review correct answers
5. **Track Progress**: Monitor your improvement over time

## API Endpoints

### Authentication
- `POST /api/auth/signup` - Create new account
- `POST /api/auth/signin` - Sign in

### Tests
- `GET /api/tests/available` - Get available tests and progress
- `GET /api/tests/[id]` - Get specific test details
- `POST /api/tests/[id]/submit` - Submit test answers

### Cron
- `GET /api/cron/generate-test` - Generate daily test (protected)

## Features in Detail

### Sequential Test Access
Users must complete all previous tests before accessing new ones. This ensures consistent learning progression.

### AI-Generated Content
Each day, Google Gemini AI generates 10 unique vocabulary words with:
- The word
- Correct meaning
- 3 plausible but incorrect options

### Score Tracking
All test attempts are saved with:
- Score (out of 10)
- User's answers
- Completion timestamp
- Date of test

## Troubleshooting

**Database connection issues:**
- Verify your `DATABASE_URL` is correct
- Ensure Neon database is active
- Check SSL mode is set correctly

**Gemini API errors:**
- Verify your `GEMINI_API_KEY` is valid
- Check API quota limits
- Ensure you're using the correct model name

**Authentication issues:**
- Clear browser localStorage
- Verify `JWT_SECRET` is set
- Check token expiration (7 days default)

## License

MIT

## Support

For issues and questions, please open an issue on GitHub.